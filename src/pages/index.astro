---
import BaseLayout from "../layouts/BaseLayout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import PostCard from "../components/PostCard.astro";
import { getCollection } from "astro:content";

const published = (p: any) => !p.data?.draft;

const research = (await getCollection("research", published))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const notes = (await getCollection("notes", published))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

// 최신 리서치 3개
const featured = research.slice(0, 3);

// 전체 문서 수 (빈약함을 숨기지 않되, 숫자보다 방법론 강조)
const totalDocs = research.length + notes.length;
---
<BaseLayout
  title="간병연구소"
  description="간병 현장의 데이터와 제도 정보를 연구·정리합니다. 간병비·인력·운영·법제도 이슈를 브리프와 가이드 형태로 축적합니다."
>
  <Header />
  <main>

    <!-- ══════ HERO ══════ -->
    <section class="hero">
      <div class="hero-accent" aria-hidden="true"></div>
      <div class="container">
        <div class="hero-inner">
          <div class="hero-content">
            <div class="eyebrow">CaregiverLab · Research & Practice Notes</div>
            <h1 class="hero-h1">
              간병 데이터와 제도 해석을<br />
              <em>실무가 바로 쓰는 문서</em>로 만듭니다.
            </h1>
            <p class="hero-sub">
              간병비·인력·운영 이슈를 브리프·가이드 형태로 축적합니다.
              각 문서에는 출처와 집계 방법을 명시합니다.
            </p>
            <div class="hero-cta">
              <a href="/research/" class="btn btn-primary">리서치 보기 →</a>
              <a href="/about/" class="btn btn-ghost">연구소 소개</a>
              <a href="/contact/" class="btn btn-ghost">자료 요청</a>
            </div>
          </div>
          <!-- Stats sidebar -->
          <div class="hero-stats">
            <div class="stat-item">
              <div class="stat-num">{totalDocs}</div>
              <div class="stat-label">공개 문서</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
              <div class="stat-num">2026</div>
              <div class="stat-label">연구소 설립</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
              <div class="stat-num">月 1회</div>
              <div class="stat-label">업데이트 주기</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ══════ TRUST SIGNALS ══════ -->
    <section class="trust-section">
      <div class="container">
        <div class="card-strip cols-3">
          <div class="cell">
            <div class="trust-icon" aria-hidden="true">文</div>
            <div class="trust-title">출처 명시 원칙</div>
            <div class="trust-body">
              현장 집계 + 공개자료 기반. 모든 문서에 출처와 집계 방식을 명기합니다.
            </div>
          </div>
          <div class="cell">
            <div class="trust-icon" aria-hidden="true">更</div>
            <div class="trust-title">정기 업데이트</div>
            <div class="trust-body">
              월 1회(이슈 발생 시 수시) 갱신. 각 문서에 최종 업데이트 일자를 표기합니다.
            </div>
          </div>
          <div class="cell" style="border-right:none;">
            <div class="trust-icon" aria-hidden="true">協</div>
            <div class="trust-title">협업 제공</div>
            <div class="trust-body">
              언론·법무·기업·학계 자료 요청 및 맞춤형 브리프 제공이 가능합니다.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ══════ RESEARCH AREAS ══════ -->
    <section class="areas-section">
      <div class="container">
        <div class="sec-head">
          <h2>연구 분야</h2>
          <span class="label">Research Areas</span>
        </div>
        <div class="areas-grid">
          {[
            { ko: "간병 비용·수가", en: "Cost & Fee",        icon: "₩", desc: "간병비 시세, 요양보호사 인건비, 건강보험 수가 분석" },
            { ko: "인력 제도",     en: "Workforce",          icon: "人", desc: "요양보호사 자격·배치 기준, 인력 수급 현황" },
            { ko: "법적 보호",     en: "Legal Protection",   icon: "法", desc: "성년후견, 노인복지법, 의료동의 관련 법제도" },
            { ko: "시설·운영",     en: "Facility & Ops",     icon: "建", desc: "요양원·요양병원 운영 기준, 평가지표, 입소 절차" },
            { ko: "정책·제도",     en: "Policy",             icon: "政", desc: "노인장기요양보험, 돌봄 정책, 예산 분석" },
            { ko: "데이터·통계",   en: "Data & Stats",       icon: "統", desc: "공공 통계 가공·해석, 현장 실태조사 요약" },
          ].map(a => (
            <div class="area-card">
              <div class="area-icon" aria-hidden="true">{a.icon}</div>
              <div class="area-ko">{a.ko}</div>
              <div class="area-en">{a.en}</div>
              <div class="area-desc">{a.desc}</div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- ══════ FEATURED RESEARCH ══════ -->
    <section class="featured-section">
      <div class="container">
        <div class="sec-head">
          <h2>최신 리서치</h2>
          <a href="/research/" class="see-all">전체 보기 →</a>
        </div>

        {featured.length > 0 ? (
          <div class:list={["card-strip", featured.length === 1 ? "cols-1" : featured.length === 2 ? "cols-2" : "cols-3"]}>
            {featured.map(p => <PostCard post={p} />)}
          </div>
        ) : (
          <div class="empty-state">
            첫 번째 리서치 브리프가 곧 공개됩니다.
          </div>
        )}

        {notes.length > 0 && (
          <>
            <div class="sec-head" style="padding-top: 36px;">
              <h2>실무노트</h2>
              <a href="/notes/" class="see-all">전체 보기 →</a>
            </div>
            <div class:list={["card-strip", notes.length === 1 ? "cols-1" : "cols-2"]}>
              {notes.slice(0, 2).map(p => <PostCard post={p} />)}
            </div>
          </>
        )}
      </div>
    </section>

    <!-- ══════ METHODOLOGY ══════ -->
    <section class="method-section">
      <div class="container">
        <div class="method-inner">
          <div class="method-left">
            <div class="eyebrow" style="margin-bottom: 16px;">연구 방법론</div>
            <h2 class="method-h2">
              숫자가 아닌<br />
              <em>해석</em>을 제공합니다
            </h2>
            <p class="method-body">
              간병연구소는 공공 통계와 현장 데이터를 수집·분석하여, 실무 담당자가 즉시 활용할 수 있는 형태로 재구성합니다. 모든 문서는 출처와 집계 방식을 명시하며, 불확실한 수치에는 신뢰도 등급을 표기합니다.
            </p>
            <a href="/about/#methodology" class="btn btn-ghost" style="margin-top: 20px;">
              방법론 자세히 보기
            </a>
          </div>
          <div class="method-right">
            {[
              { step: "01", title: "자료 수집", body: "건강보험공단·통계청·고용부 공개자료, 현장 인터뷰, 판례·행정해석 취합" },
              { step: "02", title: "검증·교차확인", body: "복수 출처 대조, 연도·기준 통일, 이상치 제거 및 주석 처리" },
              { step: "03", title: "실무 재구성", body: "정책 담당자·간병 종사자·가족 돌봄인이 바로 쓸 수 있는 포맷으로 편집" },
              { step: "04", title: "공개·업데이트", body: "출처 명시 후 공개. 제도 변경·신규 데이터 발표 시 즉시 갱신" },
            ].map(s => (
              <div class="method-step">
                <div class="method-step-num">{s.step}</div>
                <div>
                  <div class="method-step-title">{s.title}</div>
                  <div class="method-step-body">{s.body}</div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>

    <!-- ══════ B2B/산학/B2G CTA ══════ -->
    <section class="cta-section">
      <div class="container">
        <div class="cta-band">
          <div class="cta-watermark" aria-hidden="true">研</div>
          <div class="cta-left">
            <div class="eyebrow" style="color: var(--gold); margin-bottom: 12px;">
              자료 요청 · 협업 · 제휴
            </div>
            <h2 class="cta-h2">간병 관련 자료가 필요하신가요?</h2>
            <p class="cta-body">
              기사·보도자료 · 법률·의료 자문 지원 · 기업 컨설팅 · 학술 공동연구 등,<br />
              목적에 맞춰 브리프 형태로 정리해 드립니다.
            </p>
            <div class="cta-btns">
              <a href="/contact/" class="btn btn-inv">문의하기 →</a>
              <a href="/about/#partnership" class="btn btn-ghost-inv">협업 유형 보기</a>
            </div>
          </div>
          <div class="cta-right">
            {[
              { label: "B2B", desc: "기업·기관 대상 간병 제도 컨설팅 및 직원 교육 자료" },
              { label: "산학협력", desc: "연구자·대학원생 공동연구, 데이터 공유 협의" },
              { label: "B2G", desc: "정책 입안 지원, 의회·행정기관 브리핑 자료 제공" },
            ].map(c => (
              <div class="cta-type">
                <span class="cta-type-label">{c.label}</span>
                <span class="cta-type-desc">{c.desc}</span>
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>

  </main>
  <Footer />
</BaseLayout>

<style>
/* ── Hero ── */
.hero {
  padding: 72px 0 60px;
  border-bottom: 1px solid var(--bd);
  position: relative;
  overflow: hidden;
}
.hero-accent {
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--accent), var(--gold) 55%, transparent);
}
.hero-inner {
  display: grid;
  grid-template-columns: 1fr 220px;
  gap: 48px;
  align-items: start;
}
.hero-h1 {
  font-family: var(--serif);
  font-weight: 600;
  font-size: clamp(26px, 4vw, 38px);
  line-height: 1.5;
  letter-spacing: -0.015em;
  color: var(--ink);
  margin: 14px 0 16px;
}
.hero-h1 em {
  font-style: italic;
  color: var(--accent);
}
.hero-sub {
  font-size: 15px;
  font-weight: 300;
  line-height: 1.75;
  color: var(--muted);
  max-width: 460px;
  margin-bottom: 28px;
}
.hero-cta { display: flex; gap: 8px; flex-wrap: wrap; }

/* Stats */
.hero-stats {
  display: flex;
  flex-direction: column;
  border: 1px solid var(--bd);
  border-radius: var(--r);
  overflow: hidden;
  align-self: start;
  margin-top: 4px;
}
.stat-item { padding: 18px 20px; text-align: center; }
.stat-num {
  font-family: var(--roman);
  font-size: 24px;
  font-weight: 500;
  color: var(--ink);
  line-height: 1.2;
}
.stat-label {
  font-family: var(--roman);
  font-size: 11px;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--subtle);
  margin-top: 4px;
}
.stat-divider { border-top: 1px solid var(--bd); }

/* ── Trust ── */
.trust-section { padding: 28px 0; border-bottom: 1px solid var(--bd); }
.trust-icon {
  font-family: var(--serif);
  font-size: 28px;
  color: var(--gold);
  margin-bottom: 10px;
  opacity: 0.7;
}
.trust-title {
  font-family: var(--serif);
  font-weight: 600;
  font-size: 14px;
  color: var(--ink);
  margin-bottom: 6px;
}
.trust-body {
  font-size: 13px;
  font-weight: 300;
  line-height: 1.65;
  color: var(--muted);
}

/* ── Areas ── */
.areas-section { padding: 8px 0 0; border-bottom: 1px solid var(--bd); }
.areas-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0;
  border: 1px solid var(--bd);
  border-radius: var(--r);
  overflow: hidden;
  margin-bottom: 40px;
}
.area-card {
  padding: 22px 20px 20px;
  border-right: 1px solid var(--bd);
  border-bottom: 1px solid var(--bd);
  transition: background 0.14s;
}
.area-card:hover { background: var(--cream); }
.area-card:nth-child(3n) { border-right: none; }
.area-card:nth-last-child(-n+3) { border-bottom: none; }
.area-icon {
  font-family: var(--serif);
  font-size: 24px;
  color: var(--accent);
  opacity: 0.6;
  margin-bottom: 10px;
}
.area-ko {
  font-family: var(--serif);
  font-weight: 600;
  font-size: 15px;
  color: var(--ink);
  margin-bottom: 2px;
}
.area-en {
  font-family: var(--roman);
  font-size: 11px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--subtle);
  margin-bottom: 8px;
}
.area-desc {
  font-size: 12px;
  font-weight: 300;
  line-height: 1.6;
  color: var(--muted);
}

/* ── Featured ── */
.featured-section { padding: 0 0 8px; border-bottom: 1px solid var(--bd); }
.empty-state {
  margin-top: 0;
  border: 1px dashed var(--bd);
  border-radius: var(--r);
  padding: 28px 22px;
  font-size: 13px;
  font-weight: 300;
  color: var(--muted);
}

/* ── Methodology ── */
.method-section {
  padding: 8px 0;
  border-bottom: 1px solid var(--bd);
  background: var(--cream);
}
.method-inner {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 60px;
  align-items: start;
  padding: 40px 0;
}
.method-h2 {
  font-family: var(--serif);
  font-weight: 600;
  font-size: 24px;
  line-height: 1.5;
  color: var(--ink);
  margin-bottom: 16px;
}
.method-h2 em { font-style: italic; color: var(--accent); }
.method-body {
  font-size: 14px;
  font-weight: 300;
  line-height: 1.8;
  color: var(--muted);
}
.method-step {
  display: flex;
  gap: 18px;
  align-items: flex-start;
  padding: 18px 0;
  border-bottom: 1px solid var(--bd-light);
}
.method-step:last-child { border-bottom: none; }
.method-step-num {
  font-family: var(--roman);
  font-size: 13px;
  letter-spacing: 0.08em;
  color: var(--gold);
  min-width: 28px;
  padding-top: 2px;
}
.method-step-title {
  font-family: var(--serif);
  font-weight: 600;
  font-size: 14px;
  color: var(--ink);
  margin-bottom: 4px;
}
.method-step-body {
  font-size: 13px;
  font-weight: 300;
  line-height: 1.65;
  color: var(--muted);
}

/* ── CTA ── */
.cta-section { padding: 40px 0 48px; }
.cta-band {
  background: var(--ink);
  border-radius: var(--r);
  padding: 44px 40px;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 48px;
  align-items: center;
  position: relative;
  overflow: hidden;
}
.cta-watermark {
  position: absolute;
  right: 32px;
  top: -20px;
  font-family: var(--serif);
  font-size: 140px;
  font-weight: 700;
  color: rgba(255,255,255,0.035);
  line-height: 1;
  pointer-events: none;
  user-select: none;
}
.cta-h2 {
  font-family: var(--serif);
  font-weight: 600;
  font-size: 22px;
  color: #fff;
  margin-bottom: 10px;
  letter-spacing: -0.01em;
}
.cta-body {
  font-size: 14px;
  font-weight: 300;
  line-height: 1.75;
  color: rgba(255,255,255,0.55);
  margin-bottom: 24px;
}
.cta-btns { display: flex; gap: 10px; flex-wrap: wrap; }
.cta-right {
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-width: 220px;
}
.cta-type {
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 14px 16px;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--r);
}
.cta-type-label {
  font-family: var(--roman);
  font-size: 11px;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--gold);
}
.cta-type-desc {
  font-size: 12px;
  font-weight: 300;
  color: rgba(255,255,255,0.5);
  line-height: 1.55;
}

/* ── Responsive ── */
@media (max-width: 760px) {
  .hero-inner { grid-template-columns: 1fr; gap: 32px; }
  .hero-stats { flex-direction: row; }
  .stat-item { flex: 1; }
  .stat-divider { width: 1px; height: auto; border-top: none; border-left: 1px solid var(--bd); }
  .method-inner { grid-template-columns: 1fr; gap: 32px; }
  .cta-band { grid-template-columns: 1fr; gap: 28px; padding: 32px 24px; }
  .cta-right { flex-direction: row; flex-wrap: wrap; }
  .cta-type { flex: 1; min-width: 140px; }
}
@media (max-width: 560px) {
  .areas-grid { grid-template-columns: 1fr 1fr; }
  .area-card:nth-child(3n) { border-right: 1px solid var(--bd); }
  .area-card:nth-child(2n) { border-right: none; }
  .area-card:nth-last-child(-n+2) { border-bottom: none; }
  .area-card:nth-last-child(-n+3) { border-bottom: 1px solid var(--bd); }
}
</style>
